function getBrowserLanguage(){var e=navigator.language||navigator.userLanguage,t=e.substring(0,2);return t}function makeMenu(){var e=getBrowserLanguage();$("head").first().append('<link rel="stylesheet" href="custom.css"');var t="de"==e?"Lesen":"Read",n="de"==e?"Ausführen":"Execute",a="de"==e?"Code ausblenden/einblenden":"Show / Hide Code",l="de"==e?"Code-Zellen in der gegebenen Reihenfolge ausführen!":"Execute Cells in the Sequence Given!",o="de"==e?"Speichern":"Save",i='<div id="navbar">\n  <a href="#" role="button" id="read-button" class="btn btn-primary" onclick="setView()">'+t+'</a>\n  <a href="#" role="button" id="execute-button" class="btn btn-primary" onclick="setExecute()">'+n+'</a>\n  <a href="#" role="button" class="btn btn-primary" onclick="toggleInput()">'+a+'</a>\n  <a href="#" role="button" class="btn btn-primary" onclick="saveHtml()">'+o+'</a>\n  <a id="evalWarning" href="#" role="button" class="btn btn-warning" style="display: none;">'+l+'</a>\n  <img src="https://netmath.vcrp.de/downloads/Systeme/css/images/netmath-logo.png" width="45px"\n    style="float:right;"></img>\n  </div>';$("body").prepend(i)}function scrollFunction(){var e=document.getElementById("navbar"),t=e.offsetTop;window.pageYOffset>=t?e.classList.add("sticky"):e.classList.remove("sticky")}function saveHtml(){saveAddSageCells(".nb-code-cell",".sagecell_input,.sagecell_output"),$("script").html().replace(/\u200B/g,"");var e=new Blob(["<!DOCTYPE html>\n<html>\n<head>"+$("head").html()+'</head>\n<body>\n<div id="main">'+$("#main").html()+'</div>\n  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>\n  <script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script>\n  <script src="https://dahn-research.eu/nbplayer/vendor/js/FileSaver.min.js"></script>\n  <script src="https://dahn-research.eu/nbplayer/js/nbrunner.min.js"></script>\n  <script>\n    playerConfig='+JSON.stringify(playerConfig)+";\n    playerMode="+JSON.stringify(playerMode)+";\n    mtin="+JSON.stringify(mtin)+";\n    mtout="+JSON.stringify(mtout)+";\n    makeMenu();\n    localize();\n    loadStatus();\n    makeSageCells(playerConfig);\n    launchPlayer();\n  </script>\n  </body></html>"],{type:"text/plain;charset=utf-8"});saveAs(e,"Output.html")}function makeSageCells(e){sagecell.makeSagecell({inputLocation:"div.compute",languages:[e.lang],evalButtonText:"de"==getBrowserLanguage()?"Ausführen":"Execute",linked:e.linked,autoeval:e.eval,hide:e.hide})}function saveAddSageCells(e,t){let n="\n  <div class='compute'>\n    <script type='text/x-sage'>1+1</script>\n  </div>";$(e).each(function(){$(this).append(n);let e=getSageInput($(this));e=e.replace(/\u200B/g,""),$(this).find(".compute script").text(e),t&&$(this).find(t).remove(),$(this).find(".compute").hide()})}function getSageInput(e){let t="";return e.find(".CodeMirror-line").each(function(){t+=$(this).text()+"\n"}),t}function launchPlayer(){playerMode.showSage?setExecute():setView()}function setView(){$(".compute").hide(),playerMode.showNotebookInput&&$(cellInput).show(),$(cellOutput).show(),playerMode.showSage=!1,$("#evalWarning").hide()}function setExecute(){$(cellInput).hide(),$(cellOutput).hide(),$(".compute").show(),playerMode.showSage=!0,$("#evalWarning").show()}function toggleInput(){playerMode.showSage?($(".compute .sagecell_input").toggle(),playerMode.showSageInput=!playerMode.showSageInput):($(cellInput).toggle(),playerMode.showNotebookInput=!playerMode.showNotebookInput)}function makeTransferData(){$(".nbdataIn,.nbdataOut").parents(".nb-cell").each(function(){let e=$(this);e.before('<div id="transferData" class="transferData"></div>');let t=e.prev(),n=e.next();e.appendTo(t),n.appendTo(t);if(t.find(".nbdataOut").length){getBrowserLanguage();t.append('<p><input type="button" role="button" class="btn btn-primary continueButton" onclick="status2ClipBoard()" value="Copy status to clipboard" /></p>');let e=t.find(".successor").length;if(e){t.find("ul").children("a").remove(),t.append('<p id="contMsg">Continue reading:</p>'),t.append("<ul></ul>");let e=t.children().last();t.find(".successor").each(function(){let t=$(this).find("a").first().attr("href");t=t.replace("ipynb","html"),$(this).find("a").attr("href",t),$(this).appendTo(e),$(this).append(' <input type="button" role="button" class="btn btn-primary openWithStatus" onclick="openWithStatus(\''+t+'?status=true\')" value="Open with current status" />')})}}})}function getStatus(){return status=$(".transferData .sagecell_stdout").first().text()}function openWithStatus(e){let t=getStatus();if(t.length)localStorage.setItem("mtStatus",t),window.open(e,"_blank");else{let e=getBrowserLanguage(),t="";t="de"==e?"Fehler: Die Statusberechnung wurde noch nicht ausgeführt":"Error: Status cell not yet executed",alert(t)}}function status2ClipBoard(){let e=$(".transferData .sagecell_stdout").first().text(),t=getBrowserLanguage(),n="";e.length?(n="de"==t?"Status in die Zwischenablage kopiert":"Status copied to clipboard",copyToClipboard(e),alert(n)):(n="de"==t?"Fehler: Die Statusberechnung wurde noch nicht ausgeführt":"Error: Status cell not yet executed",alert(n))}function GetURLParameterWithDefault(e,t){for(var n=window.location.search.substring(1),a=n.split("&"),l=0;l<a.length;l++){var o=a[l].split("=");if(o[0]==e)return decodeURIComponent(o[1])}return t}function loadStatus(){if(GetURLParameterWithDefault("status",!1)){let e=localStorage.getItem("mtStatus");e&&$(".transferData").each(function(){let t=$(this);t.find(".nbdataIn").length&&t.find(".nb-code-cell script").html(e+'\nprint("Status restored")')})}}function localize(){let e={".continueButton":{type:"value",de:"Status  in die Zwischenablage kopieren",en:"Copy status to clipboard"},"#contMsg":{type:"html",de:"Weiterlesen:",en:"Continue reading:"},".openWithStatus":{type:"value",de:"Mit aktuellem Status öffnen",en:"Open with current status"}},t=getBrowserLanguage(),n=Object.keys(e);for(let a=0;a<n.length;a++){let l=n[a];e[l][t]&&("html"==e[l].type?$(l).html(e[l][t]):$(l).attr(e[l].type,e[l][t]))}}function checkInterfaceConsistency(){let e=[];$(".nb-cell[mtheading]").each(function(){let t=$(this).attr("mtheading");if(t in mtin){let n=mtin[t];for(let a=0;a<n.length;a++)""!=n[a]&!e.includes(n[a])?($(".nb-cell[mtsection="+t+"]").hide(),$(".nb-cell[mtchapter="+t+"]").hide(),$(this).find("img").first().hide()):$(this).find("img").first().show();$(".nb-cell[mtchapter="+t+"]:visible").length?e=e.concat(mtout[t]):$(".nb-cell[mtsection="+t+"]:visible").length&&(e=e.concat(mtout[t]))}})}function toggleCollapsGif(e){let t=$(".nb-cell[mtheading="+e+"]").find("img").first();t.attr("src",t.attr("src")==expandGifUrl?collapsGifUrl:expandGifUrl)}function toggleChapter(e){toggleCollapsGif(e),$(".nb-cell[mtchapter="+e+"]").toggle(),checkInterfaceConsistency()}function toggleSection(e){toggleCollapsGif(e),$(".nb-cell[mtsection="+e+"]").toggle(),checkInterfaceConsistency()}window.onscroll=function(){scrollFunction()};let playerConfig={lang:"sage",linked:!0,eval:!1,hide:["fullScreen"],execute:!0,showRead:!0,collapsable:!1},cellInput=".nb-input",cellOutput=".nb-output",codeCell=".nb-code-cell",playerMode={showSage:!1,showNotebookInput:!0,showSageInput:!0};const copyToClipboard=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t);const n=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);t.select(),document.execCommand("copy"),document.body.removeChild(t),n&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(n))};var expandGifUrl="./resources/expand.gif",collapsGifUrl="./resources/collapse.gif";