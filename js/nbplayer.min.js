function getCookie(e){for(var t=e+"=",a=decodeURIComponent(document.cookie),n=a.split(";"),i=0;i<n.length;i++){for(var l=n[i];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return l.substring(t.length,l.length)}return""}function initializePlayer(){var e=getCookie("sageLang");""==e&&(e="sage"),$("#sageLang").find("option[value='"+e+"']").prop("selected",!0),e=getCookie("sageCellsType"),""==e&&(e="linked"),$("#sageCellsType").find("option[value='"+e+"']").prop("selected",!0),e=getCookie("playerPanes"),""==e&&(e="ExecRead"),$("#playerPanes").find("option[value='"+e+"']").prop("selected",!0)}function makePlayer(){makePlayerConfig();var e=document.getElementById("file").files.item(0).name;playerConfig.name=e.substring(0,e.indexOf(".")),$("a").each(function(){$(this).text().match(/^\s*$/)&&$(this).remove()}),$('script[src="http://www.google-analytics.com/ga.js"]').remove(),$("#welcome").remove(),$("#controls").remove(),$("#help").remove(),$("#footer").remove(),makeMenu(),addSagecells(".nb-code-cell",".nb-input"),makeTransferData(),makeSageCells(playerConfig),absolutize(),playerConfig.execute&&setExecute()}function makePlayerConfig(){playerConfig.lang=$("#sageLang").val(),document.cookie="sageLang="+playerConfig.lang;var e=$("#sageCellsType option").filter(":selected").val();switch(e){case"auto":playerConfig.linked=!1,playerConfig.eval=!0;break;case"single":playerConfig.linked=!1,playerConfig.eval=!1;break;default:playerConfig.linked=!0,playerConfig.eval=!1}document.cookie="sageCellsType="+e;var t=$("#playerPanes option").filter(":selected").val();playerConfig.panes=t,playerConfig.execute="ReadExec"!=t,playerConfig.showRead="Exec"!=t,document.cookie="playerPanes="+t}function addSagecells(e,t){var a="\n  <div class='compute'>\n    <script type='text/x-sage'>1+1</script>\n  </div>";let n="";$(e).each(function(){$(this).append(a),n=$(this).find(t).text().replace(/figure/g,"% figure"),$(this).find(".compute script").text(n),$(this).find(".compute").hide()})}function absolutize(){$("script").each(function(){let e=$(this).attr("src");e&&"http"!=e.substring(0,4)&&"./"==e.substring(0,2)&&(e=e.substring(1),$(this).attr("src",playerPath+e))}),$('link[rel="stylesheet"]').each(function(){let e=$(this).attr("href");e&&"http"!=e.substring(0,4)&&"./"==e.substring(0,2)&&(e=e.substring(1),$(this).attr("href",playerPath+e))})}initializePlayer();